
<section id="task-lists-header">
  <h1 class="inline">Task Lists </h1>   

  <% if current_user? user %>
    <a href="#" data-target="#new-task-modal" data-toggle="modal" class="action-link"><%= fa_icon "plus-circle" %> New Task List</a>
  <% end %>
</section>

<%= render "/task_lists/form", task_list: TaskList.new %>

<div id="task-lists" class="panel-group collection">
  <div class="panel panel-default">
  <% task_lists.each do |task_list| %>
    <div class="panel-heading item">
      
      <div class="action-status inline">
        <% if current_user? user %>
          
          <% if task_list.public %>
              
              <%= link_to task_list_path(task_list, task_list: {public: false}), method: :put, class: "public" do %>
                <%= fa_icon "public" %>
              <% end %>
              
            <% else %>
              
              <%= link_to task_list_path(task_list, task_list: {public: true}), method: :put, class: "public" do %>
                <%= fa_icon "private" %>
              <% end %>

          <% end %>

        <% else %>
          
          <% if task_list.favorited_by.include?(current_user) %>
            
            <%= link_to unfavorite_task_list_path(task_list), class: "favorite", method: :delete do %>
              <%= fa_icon "favorite" %>
            <% end %>

          <% else %>
            
            <%= link_to favorite_task_list_path(task_list), class: "favorite", method: :post do %>
              <%= fa_icon "unfavorite" %>
            <% end %>
              
          <% end %>

        <% end %>
      </div>
    
      <a class="collapsed action-link" data-toggle="collapse" data-parent="#task-lists" href="#tasks<%= task_list.id %>">
        <%= task_list.name %>
      </a>
      
      <%= link_to '', task_list_path(task_list), method: :delete, class: "delete" if current_user? user %>      
    </div>
    <div id="tasks<%= task_list.id %>" class="panel-collapse collapse">
      <div class="panel-body">
        <% if task_list.tasks.empty? %>
          <div class="alert alert-warning">
            <%= fa_icon "exclamation-circle" %> This Task List has no Tasks
          </div>
        <% end %>
        <ul>
        <% task_list.tasks.each do |task| %>
          <li> <%= task.name %> </li>
        <% end %>
        </ul> 
      </div>
    </div>
  <% end %>
  </div>
</div>

  
